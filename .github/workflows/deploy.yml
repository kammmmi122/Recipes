name: Deploy

on:
  workflow_run:
    workflows: ["Build asciidoc"]
    types:
      - completed

jobs:
  deploy:
    runs-on: self-hosted

    environment:
      name: github-pages
      url: ${{steps.deployment.outputs.page_url}}

    if: github.ref == 'refs/heads/main'
    steps:
    - uses: dawidd6/action-download-artifact@v2.28.0
      with:
        token: ${{ secrets.PAT || secrets.GITHUB_TOKEN }}
        name: page
        path: .
    - uses: actions/configure-pages@main
    - uses: actions/upload-pages-artifact@main
      with:
        path: .
    - id: deployment
      uses: actions/deploy-pages@main
